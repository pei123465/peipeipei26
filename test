カテゴリ,ポイント,設計で決めること（入力）,推奨/留意点
スコープ,対象OU,本番OU/開発OU/管理OUの適用範囲,"原則は全OU適用、OU別例外は追加ポリシーで表現"
スコープ,対象VPC,対象外にするVPCがあるか,"基本は全VPC。例外VPCを作るなら理由と期限を必ず定義"
スコープ,対象リージョン,東京のみ/将来大阪追加時の方針,"FMS/DNS Firewall/Resolver Query Logsはリージョン単位。大阪用も同等に作る前提でIaC化"
管理,FMS委任管理者,FMS委任管理者に指定するアカウント,"管理環境OUのセキュリティアカウントを固定。変更は原則不可"
管理,Organizations前提,AWS Organizations有効化状況,"全アカウントがOrganizations配下であることが前提"
管理,FMS信頼アクセス,Firewall Managerの信頼アクセス設定,"OrganizationsでFirewall Managerの信頼アクセスを有効化"
管理,AWS RAM共有設定,RAMの組織共有有効化,"DNS Firewallルールグループ共有に必須"
管理,権限分離,誰がルール変更できるか,"本番影響があるため変更権限は最小化。申請フロー必須"
構成,配布方式,FMSでの自動関連付け有無,"手動関連付けは禁止。FMS強制適用を前提"
構成,ポリシー分割,ポリシーを分ける粒度,"全社共通ベースライン＋OU別追加ポリシーの構成が安定"
構成,OUスコープ指定,OU/アカウント指定方針,"OU指定を原則としアカウント個別指定は避ける"
構成,リージョン別ポリシー,リージョン単位管理方針,"東京/大阪で同等ポリシーを作成する前提"
構成,新規アカウント対応,新規アカウント/VPCへの適用,"OU配下追加時に自動適用される前提で設計"
構成,既存VPC影響,既存VPCへの反映タイミング,"有効化後すぐ適用されるため事前影響評価必須"
構成,除外VPC対応,特定VPCを除外するか,"原則除外しない。除外が必要ならOU分離を検討"
構成,ルールグループ階層,Global/OU別/例外の分け方,"Globalベースライン＋OU別Allow例外の二段構え"
構成,評価順序,Allow/Alert/Blockの並び,"Allow例外を最優先。順序ミスは重大事故要因"
構成,命名規約,ルールグループ/ドメインリスト命名,"番号付き命名で評価順が分かる形に統一"
構成,初期導入モード,Alert開始範囲,"全ルールAlert開始。業務影響を潰してからBlock移行"
構成,Block移行方式,Alert→Block切替方法,"既存ルール変更 or Block専用RG追加。後者が分かりやすい"
ドメインリスト,AWS Managed List,使用するManaged list,"まずAlert。誤検知確認後にBlock検討"
ドメインリスト,カスタム禁止候補,自社独自で監視するドメイン,"根拠と棚卸し周期をセットで定義"
ドメインリスト,Allow例外,OU別Allowの範囲,"肥大化防止。例外はOU別RGに隔離し期限管理"
ドメインリスト,内部ドメイン扱い,PHZ/オンプレ内部サフィックス,"誤検知防止で必要最小限をAllow"
名前解決,PHZ存在,各アカウントPHZの扱い,"DNS FirewallはPHZ内解決を直接統制しない点を明記"
名前解決,PHZガバナンス,PHZの命名/権限/共有,"命名衝突防止と本番OUでの権限制御が重要"
名前解決,オンプレDNS連携,Inbound Endpointフォワード範囲,"オンプレ起点でも外部解決時はFirewall評価対象"
名前解決,フォワード境界,条件付きフォワード定義,"ループ防止。AWS/オンプレ境界を明文化"
名前解決,DHCP設定,DHCP Option SetのDNS指定,"AmazonProvidedDNS(.2)を経由しない構成は禁止"
ログ,ログ種別,使用するログ,"DNS Firewall判定はResolver Query Logsのみ"
ログ,集約先,S3集約バケット,"ログ集約アカウント単一バケットに集約"
ログ,クロスアカウント,S3書き込み許可設計,"バケットポリシーでOU/アカウントを制限"
ログ,プレフィックス設計,ログパス構成,"region/account/dateを最低限含める"
ログ,暗号化方式,SSE-S3 or SSE-KMS,"SSE-KMSはキー/ポリシー管理負荷に注意"
ログ,保持期間,ライフサイクル方針,"開発OUは短め等、環境差分を許容"
ログ,オンプレ起点判定,srcaddr判定用IPレンジ,"オンプレDNS送信元IPを台帳化"
ログ,PHZ切り分け,内部解決ログの識別,"PHZサフィックス一覧で分析時に除外"
監視,リアルタイム性,即時通知の要否,"S3のみか、CloudWatch/SIEM連携するか決める"
監視,KPI定義,監視指標,"Alert件数、Block件数、急増、OU別比較"
運用,例外申請,Allow追加フロー,"申請・承認・期限・棚卸しを必須化"
運用,棚卸し,定期レビュー周期,"月次/四半期で例外とAlertを見直す"
運用,変更管理,本番反映手順,"開発OU→本番OUの順で適用"
運用,ドリフト対策,FMS管理前提の周知,"手動変更は自動復旧される前提を明示"
FMS運用,コンプライアンス監視,FMS非準拠検知,"NON_COMPLIANTを定期確認"
FMS運用,適用失敗対応,ポリシー失敗時対応,"RAM共有漏れ/権限不足を重点確認"
FMS運用,権限設計,メンバー管理者権限,"DNS Firewall直接操作は禁止"
FMS運用,ロールバック,戻し手順,"IaC管理で直前状態へ戻せるようにする"
FMS監査,変更証跡,操作ログ取得,"CloudTrailでFMS/Resolver操作を記録"
セキュリティ,責任分界,DNSと通信制御の分担,"DNSは名前解決、通信遮断は別レイヤ"
コスト,ログ量見積,DNSクエリ量想定,"EKS/ECSはログ量増大に注意"
コスト,段階導入,導入順序,"開発OU→本番OUの段階導入が安全"
IaC,構成管理方式,Terraform/CFn/StackSets,"東京→大阪展開を見据えてコード化"
IaC,パラメータ管理,Allow例外の管理方法,"CSV/リポジトリ管理で監査可能に"
テスト,検証項目,テスト観点,"Alert/Block/ログ到達をテストドメインで確認"
テスト,障害時挙動,DNS障害時影響,"Inbound/Outbound Endpoint依存点を評価"
